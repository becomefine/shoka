---
title: 遗传算法详解
math: true
date: 2022-05-09 11:54:27
categories:
 - [机器学习,机器学习算法]
tags: 
 - 机器学习
 - 机器学习算法
 - 数学算法
---

# 遗传算法详解

## 什么是遗传算法

遗传算法(Genetic Algorithm, 简称GA)起源于对生物系统所进行的计算机模拟研究，是一种`随机全局搜索优化方法`，它模拟了自然选择和遗传中发生的**复制**、**交叉(crossover)**和**变异(mutation)**现象，从任一初始种群(Population)出发，通过随机选择、交叉和变异操作，产生一群更适合环境的个体，使群体进化到搜索空间越来越好的区域，这样一代一代不断繁衍进化，最后收敛到一群最适应环境的个体(Individual)，从而求得问题的最优解。

## 常见术语

1、**染色体(Charomosome)**: 染色体又称为基因型个体(individuals), 一定数量的个体组成了群体(population)，群体中个体的数量叫做群体大小(population size)。
2、**位串(Bit String)**: 个体的表示形式。对应于遗传学中的染色体。
3、**基因(Gene)**: 基因是染色体中的元素，用于表示个体的特征。例如有一个串(即染色体)S=1011，则其中的1,0,1,1这4个元素分别成为基因。
4、**特征值(Feature)**: 在用串表示整数时，基因的特征值与二进制数的权一致；例如在串S=1011中基因位置3中的1，它的基因特征值为2；基因位置1中的1，它的基因特征值为8.
5、**适应度(Fitness)**: 各个个体对环境的适应程度叫做(fitness)。为了体现染色体的适应能力，引入了对问题中的每一个染色体都能进行度量的函数，叫适应度函数。这个函数通常会被用来计算个体在全体中被使用的概率。
6、**基因型(Genotype)**: 或称遗传性，是指基因组定义遗传特征和表现。对应于GA中的位串。
7、**表现型(Phenotype)**: 生物体的基因型在特定环境下的表现特征。对应于GA中的位串解码后的参数。

## 遗传算法基本过程

基本遗传算法(也称为标准遗传算法或简单遗传算法，Simple Genetic Algorithm，简称SGA)是一种群体型操作，该操作以群体中的所有个体为对象，只适用基本遗传算子(Genetic Operator): `选择算子(Selection Operator)`、`交叉算子(Crossover Operator)`和`变异算子(Mutation Operator)`，其遗传过程操作简单，容易理解，是其他一些遗传算法的基础，他不仅给各种遗传算法提供了一个基本框架，同时也具有一定的应用价值。`选择`、`交叉`和`变异`是遗传算法的3个主要操作算子，他们构成了遗传操作，使遗传算法具有了其他方法没有的特点。
表示方法: 
$$SGA = ( C, E, P_{0}, M, \phi, \Gamma, \psi, T)$$
其中，
$C$ 表示个体的编码方案
$E$ 表示个体适应度评价函数
$P_{0}$ 表示初始种群
$M$ 表示种群大小
$\phi$ 表示选择算子
$\Gamma$ 表示交叉算子
$\psi$ 表示变异算子
$T$ 表示遗传算法终止条件

## 遗传算法步骤

### 染色体编码

1、编码
解空间中的解在遗传算法中的表示形式。从问题的解(solution)到基因型的映射称为编码，即把一个问题的可行解从其解空间转换到遗传算法的搜素空间的转换方法。遗传算法在进行搜索之前先将解空间的解表示成遗传算法的基因型串(也就是染色体)结构数据，这些串结构数据的不同组合就构成了不同的点。
常见的编码方法有
- 二进制编码
二进制编码：即组成染色体的基因序列是由二进制数表示，具有编码解码简单易用，交叉变异易于程序实现等特点。
- 格雷码编码
两个相邻的数用格雷码表示，其对应的码位只有一个不相同，从而可以提高算法的局部搜索能力。这是格雷码相比二进制编码而言所具备的优势。
- 浮点数编码
是指将个体范围映射到对应浮点数区间范围，精度可以随浮点数区间大小而改变。
例子：
设置某一取值范围为$$[U_{1}, U_{2}]$$，我们用长度为$k$的二进制编码符号来表示该参数，则它总共产生$2^{k}$种不同的编码，可使参数编码时的对应关系：
$$ 000000···0000 = 0 \rightarrow U_{1}$$
$$ 000000···0001 = 1 \rightarrow U_{1} + \delta$$
$$ 000000···0010 = 2 \rightarrow U_{1} + 2\delta$$
$$\vdots$$
$$ 111111···1111 = 2_{k} - 1 \rightarrow U_{2}$$
其中, $\delta = \frac{U_{2} - U_{1}}{2_{k} - 1}$
- 各参数级联编码
- 多参数交叉编码

2、解码
遗传算法染色体向问题解的转换。假设某一个体的编码，则对应的价码公式为
$$ X = U_{1} + (\sum_{i=1}^{k}b_{i}·2_{i-1})\frac{U_{2} - U_{1}}{2_{k} - 1}$$

举例：
设有参数 $X \in [2,4]$, 现用5位二进制编码对$X$进行编码，得$2_{5} = 32$ 个二进制串(染色体)：
$$ 0000,00001,00010,······,1111$$

对于人一个二进制中，只要带入上面公式，就可以得到对应的解码，如$x_{22} = 10101$, 它对应的十进制为
$$ \sum_{i=1}^{5}b_{i}·2^{i-1} = 1 + 0 \times 2 + 1 \times 2^2 + 0 \times 2^3 + 1 \times 2^4 = 21 $$
对应参数$X$的值为
$$2 + 21 \times \frac{4 - 2}{2^5 - 1} = 3.3548$$

### 初始群体的生成
设置最大进化次数$T$, 群体大小 $M$, 交叉概率$P_{c}$, 变异概率$P_{m}$, 随机生产$M$个个体作为初始化群体$P_{0}$

### 适应度值评估检测
适应度函数表明个体或解的优劣型。对于不同的问题，适应度函数的定义方式不同。根据具体问题，计算群体$P(t)$中各个个体的适应度。
适应度尺度变换：一般来讲，是指算法迭代的不同阶段，能够通过适当改变个体的适应度大小，进而避免群体间适应度相当而造成的竞争减弱，导致种群收敛于局部最优解。
尺度变换选用的经典方法：线性尺度变换、乘幂尺度变换以及指数尺度变换。
1、线性尺度变换
$$F' = aF + b$$
是用一个线性函数表示，其中a为比例系数，b为平移系数，F为变换前适应度尺度，$F'$为变换后适应度尺度。

2、乘幂尺度变换
$$F' = F^k$$
是将原适应度尺度$F$取$k$次幂。其中$k$为幂，$F$为转变前适应度尺度，$F'$为转变后适应度尺度。

3、指数尺度变换
$$F' = e^{\beta F}$$
是指首先将元尺度乘以一个，然后取反，将作为自然数e的幂，其中的大小决定了适应度尺度变换的强弱。

### 遗传算子

遗传算法使用以下三种遗传算子：
1、选择
选择操作从旧群体中以一定概率选择优良个体组成新的种群，以繁殖得到下一代个体。个体被选中的概率跟适应度有关，个体适应度越高，被选中的概率越大。以轮盘赌法为例，若设种群数我$M$，个体$i$的适应度为$f_{i}$，则个体$i$被选取的概率为：
$$ P_{i} = \frac {f_i}{\sum_{k=1}^{M}f_k} $$

当个体选择的概率给定后，产生$[0,1]$之间均匀随机数来决定哪个个体参加交配。若个体的选择概率大，则有机会被多次选中，那么它的遗传基因就会在种群中扩大；若个体的选择概率小，则被淘汰的可能性会大。

2、交叉
交叉操作是指从种群中随机选择两个个体，通过两个染色体的交换组合，把父串的优秀特征遗传给子串，从而产生新的优秀个体。
在实际应用中，使用最高的是单点交叉算子，该算子在配对的染色体中随机的选择一个交叉位置，然后在该交叉位置对配对的染色体进行基因位变换。该算子的执行过程如下图。

```mermaid
graph TB
    1[对种群个体执行随机配对操作] -> 2[逐一对配对的染色体，随机设置一个位置交叉点] -> 3[依照设定的交叉概率p进行相互配对] 
```
:::info no-icon
其他交叉算子包括:
a)双点交叉或多点交叉，即对配对的染色体随机设置两个或者多个交叉点，然后进行交叉运算，改变染色体基因序列。
b)均匀交叉，即配对的染色体基因序列上的每个位置都以等概率进行交叉，以此组成新的基因序列。
c)算术交叉，是指配对染色体之间采用线性组合方式进行交叉，改变染色体基因序列。
:::
![machine](/assets/machine-learning/algorithm-note/genetic-algorithm/genetic1.png)

3、变异
为了防止遗传算法在优化过程中陷入局部最优解，在搜索过程中，需要对个体进行变异，在实际应用中，主要采用单点变异，也叫位变异，即只需要对基因序列中某一个位进行变异，以二进制编码为例，即0变为1，而1变为0。
![machine](/assets/machine-learning/algorithm-note/genetic-algorithm/genetic2.png)
群体$P(t)$经过选择、交叉、变异运算后得到下一代群体$P(t+1)$。

### 终止判断条件

若$t \leq T$, 则 $t \leftarrow t + 1$, 转到步骤2；否则以进化过程中得到的具有最大适应度的个体作为最好的解输出，终止运算。

遗传算法全过程图：
```mermaid
graph TB
A[实际问题参数集] -> B[编码] -> C[种群t] -> D[计算适应值] -> E[选择与遗传] -> F[种群t+1] -> G{满足要求} --Y-> H[解码] -> I[改善或解决实际问题]
J[三种基本遗传算子:1.选择算子 2.交叉算子 3.变异算子] -> E
G --N-> K[种群t $\leftarrow$ 种群t+1] -> D
```

从遗传算法运算流程可以看出，进化操作过程简单，容易理解，给其他各种遗传算法提供了一个基本框架。

:::warning no-icon
遗传算法有4个运行参数需要预先设定，即
$Y$: 种群大小
$T$: 遗传算法的终止进化次数
$P_{c}$: 交叉概率，一般为0.4~0.99
$P_{m}$: 变异概率，一般取0.001~0.1
:::


